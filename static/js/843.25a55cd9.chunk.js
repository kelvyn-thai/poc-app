"use strict";(self.webpackChunkpoc_app=self.webpackChunkpoc_app||[]).push([[843],{9970:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(1694),i=n.n(r),a=n(1017),o=n(2791),u=n(184),c=o.forwardRef((function(e,t){var n=t.ref,r=t.refSVG,o=e.chartName,c=e.isLoading,s=e.classNameContainer,l=e.classNameSVGChart,d=e.children;return(0,u.jsxs)("div",{ref:n,className:"relative ".concat(i()(s)),children:[o&&(0,u.jsx)("div",{className:"text-center mb-5 text-xl font-medium",children:o}),c&&(0,u.jsx)(a.Z,{}),r&&(0,u.jsx)("svg",{ref:r,className:"m-auto ".concat(l)}),d&&d]})}));c.defaultProps={chartName:"",isLoading:!1,classNameContainer:"",classNameSVGChart:"",children:null};var s=c},150:function(e,t,n){n.d(t,{Lp:function(){return k}});var r,i=n(2791),a=n(9970),o=(n(1020),n(1413)),u=n(2646),c=(n(5824),n(7859)),s=n(5671),l=n(3144),d=function(){function e(){(0,s.Z)(this,e),this.stack=void 0,this.stack=[]}return(0,l.Z)(e,[{key:"push",value:function(e){this.stack.push(e)}},{key:"pop",value:function(){this.stack.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.stack[this.size-1]}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"size",get:function(){return this.stack.length}},{key:"stackItems",get:function(){return this.stack}}]),e}(),f=n(8111),p=n.n(f),m=(new d,new d),v=function e(t){var n;try{var i=t.hierachy,a=t.container,s=t.renderTooltip,l=t.width,d=t.height,f=u.Ys(a);if(!i)return void r.dispose();var v=i.geometry,g=i.children,y=void 0===g?[]:g,h=i.name,x=i.nameProperty,N=void 0===x?"name":x,b=i.id;r&&r.dispose(),n=f.append("div").attr("id",b).node(),(r=c.S1(n,void 0,{width:l,height:d})).showLoading(),function(e){var t=e.hierachy,n=e.mapName,r=e.mapEcharts,i=e.nameProperty,a=e.renderTooltip,o=t.geometry,s=t.regions,l=void 0===s?[]:s,d=u.PKp(l,u.Cn1);c.je(n,o);var f="#333D3F",m=u.$_Y(f);m.opacity=.5;var v=String(m),g={geo:{map:n,zoom:1,roam:!0,animation:!1,nameProperty:i,label:{show:!1},itemStyle:{areaColor:f,shadowColor:v,shadowOffsetX:0,shadowOffsetY:10}},series:[{name:"map",type:"map",map:n,selectedMode:!1,roam:!0,label:{show:!1,color:"#ffffff"},itemStyle:{areaColor:f,shadowColor:v,shadowOffsetX:-2,shadowOffsetY:2,shadowBlur:10},emphasis:{label:{color:"#ffffff"},itemStyle:{areaColor:"#6289AB",shadowColor:v,shadowOffsetX:0,shadowOffsetY:10}},data:l.map((function(e){var t=d(e),n=u.$_Y(t),r=n;r.opacity=1;var i=n;return i.opacity=.5,{name:e,label:{show:!1,color:"#FFF"},itemStyle:{areaColor:t,shadowColor:String(r),shadowOffsetX:0,shadowOffsetY:10},emphasis:{focus:"self",label:{color:"#FFFFFF",show:!0},itemStyle:{areaColor:t,shadowColor:String(i),shadowOffsetX:0,shadowOffsetY:10}}}}))}],tooltip:{show:!0,trigger:"item",formatter:function(e){var t=e.name,n=null===o||void 0===o?void 0:o.features.find((function(e){var n;return p()(null===e||void 0===e||null===(n=e.properties)||void 0===n?void 0:n.name,t)}));return n?a({feature:n,name:t}):""},padding:0,borderWidth:0}};r.setOption(g),r.hideLoading()}({hierachy:i,mapName:h,mapEcharts:r,nameProperty:N,renderTooltip:s});var C=m.isEmpty(),_=function(e){var t,n=e.dataIndex,r=v.features[n];return r&&(t=y.find((function(e){var t;return p()(e.name,null===r||void 0===r||null===(t=r.properties)||void 0===t?void 0:t.name)}))),t};r.on("click",(function(n){var r=_(n);r&&(m.push(i),e((0,o.Z)((0,o.Z)({},t),{},{hierachy:r})))})),r.on("dblclick",(function(n){var r=_(n);if(!C&&!r){var i=m.peek();m.pop(),e((0,o.Z)((0,o.Z)({},t),{},{hierachy:i}))}})),r.on("georoam",(function(e){var t=r.getOption();e.zoom?(t.geo[0].zoom=t.series[0].zoom,t.geo[0].center=t.series[0].center):t.geo[0].center=t.series[0].center,r.setOption(t)}))}catch(Z){}return n},g=n(184),y=n(9439),h=n(4925),x=n(1694),N=n.n(x),b=n(8340),C="D3Hierachy_styles_tooltip__IO1VA",_=["data","renderTooltip","isLoading"],Z=function(e){var t=e.data,n=e.renderTooltip,r=e.isLoading,c=(0,h.Z)(e,_),s=i.useRef(null),l=function(e){var t,r=e.feature;return t="function"===typeof n?n(e):(0,g.jsx)("div",{children:Object.entries(null===r||void 0===r?void 0:r.properties).map((function(e){var t=(0,y.Z)(e,2),n=t[0],r=t[1];return(0,g.jsxs)("div",{className:"grid gap-3 ".concat(N()(C)),children:[(0,g.jsx)("div",{className:"font-medium text-base text-black",children:n}),r&&(0,g.jsx)("div",{children:r})]},n)}))}),b.renderToString(t)};return i.useEffect((function(){if(!r&&s.current){var e=v((0,o.Z)((0,o.Z)({container:s.current},t),{},{renderTooltip:l}));return function(){e&&u.Ys(e).remove()}}}),[s,t,n]),(0,g.jsx)(a.Z,(0,o.Z)((0,o.Z)({},(0,o.Z)((0,o.Z)({},c),{},{isLoading:r,ref:{ref:s}})),{},{children:!r&&!t.hierachy&&(0,g.jsx)("div",{children:"Geojson is not valid"})}))};Z.defaultProps={renderTooltip:void 0};var k=i.memo(Z)},3286:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(3433),i=n(1413),a=n(9439),o=n(4925),u=n(2791),c=n(9970),s=n(184),l=["value","className"],d=function(e){var t=e.value,n=e.className,r=void 0===n?"":n,a=(0,o.Z)(e,l);return(0,s.jsx)("div",(0,i.Z)((0,i.Z)({className:"tooltip fixed flex justify-center items-center p-[10px] h-[40px] bg-white rounded-[4px] shadow-xl text-black ".concat(r),style:(0,i.Z)({opacity:0,visibility:"hidden"},a.style)},a),{},{children:t&&t}))};d.defaultProps={className:""};var f=u.memo(d),p=n(8340),m=f,v=n(2646),g=n(5812),y=n.n(g),h=n(4544),x=n.n(h);function N(e){for(var t=e.selector,n=e.width,r=e.padding,i=void 0===r?0:r,a=v.Ys(t),o=a.node().getComputedTextLength(),u=a.text();o>n-2*i&&u.length>0;)u=u.slice(0,-1),a.text("".concat(u,"...")),o=a.node().getComputedTextLength()}var b=function(e,t,n){var r=e/t*100;return x()(r,n||2)},C=n(7151),_=n.n(C),Z=n(1694),k=n.n(Z),E="D3Hexbin_style_pieChartInfo__xKSaP",j=["data"],T=function(e){var t=e.data,n=(0,o.Z)(e,j),l=t.pieData,d=void 0===l?[]:l,f=t.size,g=t.donutText,h=t.subDonutText,x=t.quantitiesItemOnChart,C=void 0===x?5:x,Z=t.pieChartContainerClassName,T=void 0===Z?"":Z,w=t.formatterValue,S=t.renderTooltipValue,R=u.useRef(null),L=u.useRef(null),O=u.useRef(null),D=[u.useCallback((function(e){var t=e.value,n=e.event,r=n.pageX,i=n.pageY,a="".concat(r+20,"px"),o="".concat(i-20,"px");return(0,p.renderToString)((0,s.jsx)(m,{value:t,style:{top:o,left:a,opacity:1,visibility:"visible",zIndex:Number.MAX_SAFE_INTEGER}}))}),[])],A=(0,a.Z)(D,1)[0],I=u.useMemo((function(){var e=_()(d.map((function(e){return e.value}))),t=d.map((function(t){return(0,i.Z)((0,i.Z)({},t),{},{percent:b(t.value,e)})})),n=y()(t,(function(e){return e.value}),"desc");if(n.length>C){var a=n.slice(0,C-1),o=n.slice(C,n.length-1);return[].concat((0,r.Z)(a),[{id:"other",label:"Other",value:_()(o.map((function(e){return e.value})))}]).map((function(t){return(0,i.Z)((0,i.Z)({},t),{},{percent:b(t.value,e)})}))}return n}),[d]),M=u.useMemo((function(){return v.PKp(I,v.Cn1)}),[I]),P=u.useCallback((function(e,t){if(R.current){var n=I[t.index],r=n.value,i=n.label,a="function"===typeof S?p.renderToString(S(n)):"".concat(i," has value = ").concat(r),o=A({value:a,event:e});return v.Ys(R.current).selectChild(".tooltip-container").html(o)}}),[R,I]),G=u.useCallback((function(){return I.map((function(e){var t=e.label,n=e.value,r=e.id;return(0,s.jsxs)("div",{className:"grid gap-2 mb-2 ".concat(E," last:mb-0"),children:[(0,s.jsxs)("div",{className:"grid gap-1 items-center",style:{gridTemplateColumns:"min-content 1fr"},children:[(0,s.jsx)("div",{className:"rounded-full w-2 h-2",style:{backgroundColor:M(e)}}),(0,s.jsx)("div",{className:"font-medium text-sm text-gray-500 truncate",children:t})]}),(0,s.jsx)("div",{className:"font-medium text-base text-white truncate sub-font",children:"function"===typeof w?w(e):n})]},r)}))}),[I,w]);return u.useLayoutEffect((function(){R.current&&O.current&&I&&function(e){var t=e.size,n=e.svg,r=e.data,i=e.donut,a=void 0===i?80:i,o=e.container,u=e.renderTooltip,c=e.scaleColor,s=e.donutText,l=e.subDonutText,d=v.Ys(o),f=t/2,p=v.Ys(n).attr("width",t).attr("height",t);p.html("");var m=p.append("g").attr("transform","translate(".concat(t/2,",").concat(t/2,")")),g=v.ve8(),y=a/100*f,h=f,x=v.Nb1().innerRadius(y).outerRadius(h),b=g(r.map((function(e){return e.value<.1?.1:e.value})));m.selectAll("arc").data(b).enter().append("g").attr("class","arc").append("path").attr("d",x).attr("cursor","pointer").attr("fill",(function(e,t){return c(r[t])})).on("mouseover",(function(e,t){"function"===typeof u&&u(e,t,this)})).on("mouseleave",(function(){"function"===typeof u&&d.selectChild(".tooltip-container").html("")})),s&&m.append("text").attr("class","donut-text").attr("text-anchor","middle").attr("y","0").attr("fill","#FFF").style("font-size","16px").style("font-family","BPDS_Iconfont").style("font-style","normal").style("font-weight","400").text(s).each((function(){return N({selector:this,width:2*y,padding:0})})),l&&m.append("text").attr("class","donut-text").attr("text-anchor","middle").attr("y","20").attr("fill","#6b7280").style("font-size","12px").text(l).each((function(){return N({selector:this,width:2*y,padding:0})}))}({svg:O.current,container:R.current,renderTooltip:P,data:I,size:f,scaleColor:M,donutText:g,subDonutText:h})}),[R,O,L,t,M,f]),(0,s.jsx)("div",{className:"pie-chart-container ".concat(k()(T)),children:(0,s.jsxs)("div",{className:"pie-chart grid gap-5 items-center",style:{gridTemplateColumns:"".concat(f,"px 1fr")},children:[(0,s.jsx)(c.Z,(0,i.Z)((0,i.Z)({},(0,i.Z)((0,i.Z)({},n),{},{ref:{ref:R,refSVG:O}})),{},{children:(0,s.jsx)("div",{className:"tooltip-container"})})),(0,s.jsx)("div",{className:"pie-chart-info",children:G()})]})})},w=u.memo(T)},1017:function(e,t,n){var r=n(1413),i=n(4925),a=n(1694),o=n.n(a),u=n(2791),c=n(8965),s=n(184),l=["className","isCenterAbsolute"],d=function(e){var t=e.className,n=e.isCenterAbsolute,a=(0,i.Z)(e,l);return(0,s.jsx)("div",(0,r.Z)((0,r.Z)({className:"".concat(n&&c.Z.absCenter," ").concat(o()(t))},a),{},{children:(0,s.jsx)("i",{className:"fa-solid fa-spinner fa-spin-pulse fa-2xl"})}))};d.defaultProps={className:"",isCenterAbsolute:!0},t.Z=u.memo(d)},5824:function(e,t,n){n.d(t,{V:function(){return r}});var r={PUBLIC_URL:"/poc-app",ASSETS_PATH:"".concat("/poc-app","/sampleData"),API_DOMAIN_URL:"".concat({NODE_ENV:"production",PUBLIC_URL:"/poc-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_DOMAIN_URL||"https://app-portal-ppe1.envisioniot.com","/demo_service/v1.0")}},7852:function(e,t,n){var r=n(9439),i=n(2791),a=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}};t.Z=function(){var e=(0,i.useState)(a()),t=(0,r.Z)(e,2),n=t[0],o=t[1];return(0,i.useEffect)((function(){function e(){o(a())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}},6695:function(e,t,n){n.d(t,{$e:function(){return Z},BQ:function(){return k},BY:function(){return j},Cr:function(){return _},FD:function(){return N},_r:function(){return C},bB:function(){return h},bM:function(){return x},dc:function(){return E},kZ:function(){return T},r7:function(){return b}});var r=n(1413),i=n(2064),a=n.n(i),o=n(8111),u=n.n(o),c=n(209),s=n.n(c),l=n(7291),d=n.n(l),f=n(2066),p=n.n(f),m=n(9627),v=n.n(m),g=n(6452),y=n.n(g),h="Wh",x="Wh",N="m\xb2",b="CO2e",C="CO2e/m\xb2",_={baseWatt:"Wh",kgWatt:"kWh",megaWatt:"MWh",gigaWatt:"GWh"},Z=function(e){var t=e.value,n=e.unit,r=0;try{if(!p()(t))switch(n){case"kgWatt":r=1e3*t;break;case"megaWatt":r=1e6*t;break;case"gigaWatt":r=1e9*t;break;default:r=t}}catch(i){}return r},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=1,r=_.baseWatt,i=v()(e)||0;i>=1e9?(n=1e9,r=_.gigaWatt):i>=1e6?(n=1e6,r=_.megaWatt):i>=1e3&&(n=1e3,r=_.kgWatt);var a=2,o=(y()(e)||0)/n;return o>0&&o<1&&(a=-Math.floor(Math.log10(o))),{divide:n,unit:t?"".concat(r,"/").concat(N):r,minFractionDigits:a}},E=function(e){var t=e.value,n=e.divide,r=void 0===n?1:n,i=e.fractionDigits,a=void 0===i?2:i,o=e.unit;try{var u=(t/r).toLocaleString(void 0,{minimumFractionDigits:a});return"".concat(u," ").concat(o||"")}catch(c){}return"".concat(t)},j=function(e,t){var n=[],i=[];try{if(t){var o=t.geometry;e.forEach((function(e,t){var a=function(e,t,n){try{var r=e.id,i=e.name,a=e.mapProperties,o=t.features.map((function(e){var t=e.properties,n=e.geometry;return{coordinates:n.coordinates,properties:t,type:n.type}})),c=[];return a.forEach((function(e){e.split(",").forEach((function(e){n.push(e);var t=o.find((function(t){return u()(s()(t.properties.name),s()(e))}));if(t)switch(t.type){case"LineString":c.push([t.coordinates]);break;case"Polygon":c.push(t.coordinates);break;case"MultiPolygon":t.coordinates.forEach((function(e){c.push(e)}))}}))})),{type:"Feature",id:r,geometry:{type:"MultiPolygon",coordinates:c},properties:{name:i}}}catch(l){}}(e,o,i);if(a){var c=n[t];n[t]=(0,r.Z)((0,r.Z)({},c),a)}})),i=a()(i)}}catch(c){}return{listProperties:i,features:n}},T=function(e){return(null===e||void 0===e?void 0:e.split(",").map((function(e){return d()(e)})))||[]}},3514:function(e,t,n){n.r(t),n.d(t,{ALERTS:function(){return _e},ALERTS_DISPLAY_NAME:function(){return ke},ALERT_AND_TICKETS_RECORD_COLUMN:function(){return Te},CARBON_BASE_UNIT:function(){return ie.r7},CARBON_DENSITY_BASE_UNIT:function(){return ie._r},DISPLAY_NAME:function(){return je},EC_UNITS:function(){return ie.Cr},ENERGY_BASE_UNIT:function(){return ie.bM},ENERGY_DENSITY_AREA_BASE_UNIT:function(){return ie.FD},ENERGY_RANKING_BUILDING_NAME:function(){return ge},ENERGY_RANKING_ENERGY:function(){return ye},ENERGY_RANKING_ENERGY_DENSITY:function(){return he},ENERGY_RANKING_RECORD_COLUMN:function(){return xe},GEOJSON_INFO_COUNTRY:function(){return Ne},GEOJSON_INFO_DATA:function(){return be},GEOJSON_INFO_RECORD_COLUMN:function(){return Ce},REGION_ALERT_TICKETS:function(){return de},REGION_BUILDINGS:function(){return fe},REGION_COORDINATES:function(){return ue},REGION_ENERGY_CONSUMPTION:function(){return ce},REGION_ENERGY_DENSITY_CONSUMPTION:function(){return se},REGION_FLOOR_AREA:function(){return pe},REGION_NAME:function(){return oe},REGION_OPEN_TICKETS:function(){return le},REGION_RECORD_COLUMN:function(){return ve},REGION_TIME:function(){return me},STANDARD_ENERGY_CONSUMPTION_UNIT:function(){return ie.bB},TICKETS:function(){return Ze},TICKETS_DISPLAY_NAME:function(){return Ee},activeGeojsonMap:function(){return ee},convertECByUnit:function(){return ie.$e},convertFromStringToArrayPropertyList:function(){return ie.kZ},convertMapPropertiesToCoordinates:function(){return ie.BY},createRegion:function(){return U},default:function(){return Zt},deleteEnergyRanking:function(){return re},deleteGeojsonMap:function(){return $},deleteRegion:function(){return W},findDivideBaseOnValuesEC:function(){return ie.BQ},formatterValueToLocaleString:function(){return ie.dc},getAlertsTickets:function(){return z},getCountryStatusList:function(){return te},getEnergyConsumption:function(){return q},getEnergyRanking:function(){return H},getGeojsonMapOfACountry:function(){return Y},getListCountry:function(){return J},getMapGeneral:function(){return G},getPropertyList:function(){return Q},getRegion:function(){return B},getRegionList:function(){return X},getState:function(){return _t},operationAlertsTickets:function(){return K},operationEnergyRanking:function(){return ne},operationGeojsonMapOfACountry:function(){return F},updateRegion:function(){return V},useActivedCountry:function(){return Re},useCountryStatusList:function(){return we},useEnergyConsumptionData:function(){return Ve},useEnergyRankingData:function(){return ze},useGeojsonCountry:function(){return De},useGeojsonRegions:function(){return Me},useHierachyCountryData:function(){return Ie},useMapStore:function(){return Ct},useMutationAlertsAndTickets:function(){return Xe},useMutationAutoGenerateRegion:function(){return Ye},useMutationDeleteCountry:function(){return Pe},useMutationDeleteEnergyRanking:function(){return qe},useMutationDeleteRegion:function(){return Fe},useMutationOperationEnergyRanking:function(){return Ke},useMutationOperationGeojsonMapOfACountry:function(){return Be},useMutationOperationRegion:function(){return Qe},useMutationUpdateActiveCountry:function(){return Ge},usePropertyList:function(){return Oe},useQueryAlertsAndTickets:function(){return He},useQueryAlertsAndTicketsData:function(){return Je},useQueryEnergyConsumption:function(){return Ue},useQueryEnergyRanking:function(){return We},useRegionList:function(){return Le},useRegionListData:function(){return Ae},useSelectedCountry:function(){return Se}});var r=n(2791),i=n.p+"static/media/background-map.5970f7141606477a2923.png",a=n(7852),o=n(150),u=n(1413),c=n(4925),s=n(1017),l=n(184),d=["title","children","sub","className","isLoading","classNameBlockTitle","childrenCenter","panelTitleClassName"],f=function(e){var t=e.title,n=e.children,r=e.sub,i=e.className,a=void 0===i?"":i,o=e.isLoading,f=e.classNameBlockTitle,p=e.childrenCenter,m=e.panelTitleClassName,v=void 0===m?"":m,g=(0,c.Z)(e,d);return(0,l.jsxs)("div",(0,u.Z)((0,u.Z)({className:"relative bg-[#212029] p-5 h-auto ".concat(a||"")},g),{},{children:[(0,l.jsxs)("div",{className:"grid items-center justify-between gap-3 ".concat(f),children:[(0,l.jsx)("div",{className:"panel-title font-medium text-white truncate max-w-100px ".concat(v||""),children:t}),r&&r]}),o?(0,l.jsx)(s.Z,{}):n&&(0,l.jsx)("div",{className:"".concat(p?"flex justify-center items-center":""," "),children:n})]}))};f.defaultProps={sub:null,className:"",isLoading:!1,classNameBlockTitle:"",childrenCenter:!1,panelTitleClassName:""};var p=r.memo(f),m=n(8111),v=n.n(m),g=n(7291),y=n.n(g),h=n(1694),x=n.n(h),N=["className"],b=function(e){var t=e.className,n=void 0===t?"":t,r=(0,c.Z)(e,N);return(0,l.jsx)("div",(0,u.Z)({className:"h-[1px] bg-slate-300 w-[100%] ".concat(x()(n))},r))};b.defaultProps={className:""};var C,_,Z,k,E=r.memo(b),j=n(8965),T=n(3433),w=n(4165),S=n(5861),R=n(7408),L=n(7151),O=n.n(L),D=n(7187),A=n(5824),I=n(5671),M=n(3144),P=new(function(){function e(t){var n=t.baseURL;(0,I.Z)(this,e),this.baseURL=void 0,this.controller=void 0,this.requestInit=void 0,this.baseURL=n,this.controller=new AbortController,this.requestInit={cache:"no-cache",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Access-Control-Allow-Headers":"*"},credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer"}}return(0,M.Z)(e,[{key:"get",value:function(e){var t=this.controller.signal;return fetch("".concat(this.baseURL,"/").concat(e),(0,u.Z)((0,u.Z)({},this.requestInit),{},{method:"GET",signal:t})).then((function(e){return e.json()})).catch((function(e){throw new Error(e)}))}},{key:"post",value:function(e,t){var n=this.controller.signal;return fetch("".concat(this.baseURL,"/").concat(e),(0,u.Z)((0,u.Z)({},this.requestInit),{},{method:"POST",body:JSON.stringify(t),signal:n})).then((function(e){return e.json()})).catch((function(e){throw new Error(e)}))}},{key:"put",value:function(e,t){var n=this.controller.signal;return fetch("".concat(this.baseURL,"/").concat(e),(0,u.Z)((0,u.Z)({},this.requestInit),{},{method:"PUT",body:JSON.stringify(t),signal:n})).then((function(e){return e.json()})).catch((function(e){throw new Error(e)}))}},{key:"delete",value:function(e,t){var n=this.controller.signal;return fetch("".concat(this.baseURL,"/").concat(e),(0,u.Z)((0,u.Z)({},this.requestInit),{},{method:"DELETE",body:JSON.stringify(t),signal:n})).then((function(e){return e.json()})).catch((function(e){throw new Error(e)}))}},{key:"abort",value:function(){this.controller.abort()}}]),e}())({baseURL:"".concat(A.V.API_DOMAIN_URL,"/map")}),G=function(){return P.get("general")},Y=function(e){return P.get("geojsonmap?Country=".concat(e))},F=function(e,t){return P.post("geojsonmap?Country=".concat(e),t)},Q=function(e){return P.get("geojsonmappropertylist?Country=".concat(e))},B=function(e,t){return P.get("region?Country=".concat(e,"&Region=").concat(t))},U=function(e,t,n){return P.post("region",(0,u.Z)({country:e,regionname:t},n))},V=function(e,t,n){return P.put("region",(0,u.Z)({country:e,regionname:t},n))},W=function(e){return P.post("".concat(e,"/region"),{})},z=function(e){return P.get("alertstickets?Country=".concat(e))},K=function(e){return P.post("alertstickets",e)},q=function(e){return P.get("energyconsumption?Country=".concat(e))},H=function(e){return P.get("energyranking?Country=".concat(e))},J=function(){return P.get("countrylist")},X=function(e){return P.get("regionlist?Country=".concat(e))},$=function(e){return P.delete("".concat(e,"/geojsonmap"))},ee=function(e){return P.post("".concat(e,"/geojsonmap"))},te=function(){return P.get("countrystatuslist")},ne=function(e,t,n){return P.post("energyranking?Country=".concat(e),(0,u.Z)({country:e,buildingname:t},n))},re=function(e){return P.post("".concat(e,"/energyranking"),{})},ie=n(6695),ae=n(4942),oe="regionname",ue="map_properties",ce="energy_consumption",se="energy_densisty_YTD",le="open_tickets",de="active_alerts",fe="buildings",pe="floor_area",me="time",ve=(C={},(0,ae.Z)(C,oe,"Region"),(0,ae.Z)(C,ue,"Coordinates"),(0,ae.Z)(C,ce,"Energy Consumption"),(0,ae.Z)(C,se,"Energy Density Consumption"),(0,ae.Z)(C,le,"Open tickets"),(0,ae.Z)(C,de,"Alert Tickets"),(0,ae.Z)(C,fe,"Buildings"),(0,ae.Z)(C,pe,"Floor Area"),(0,ae.Z)(C,me,"Time"),C),ge="buildingname",ye="energy",he="energy_density",xe=(_={},(0,ae.Z)(_,ge,"Building Name"),(0,ae.Z)(_,ye,"Energy"),(0,ae.Z)(_,he,"Energy Density"),_),Ne="country",be="geojson",Ce=(Z={},(0,ae.Z)(Z,Ne,"Country"),(0,ae.Z)(Z,be,"Geojson"),Z),_e="alerts",Ze="tickets",ke="alerts_display_name",Ee="tickets_display_name",je="display_name",Te=(k={},(0,ae.Z)(k,_e,"Alerts"),(0,ae.Z)(k,Ze,"Tickets"),(0,ae.Z)(k,ke,""),(0,ae.Z)(k,Ee,""),(0,ae.Z)(k,je,"Display name"),k),we=function(){var e=Ct().actionSetSelectedCountry;return(0,R.useQuery)(["country-status-list"],(0,S.Z)((0,w.Z)().mark((function e(){var t;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:return t=e.sent,e.abrupt("return",(null===t||void 0===t?void 0:t.data)||[]);case 4:case"end":return e.stop()}}),e)}))),{onSuccess:function(t){var n,r=-1;t.length>0&&(r=(null===(n=t.find((function(e){return e.actived})))||void 0===n?void 0:n.id)||-1);e(r)},placeholderData:[]})},Se=function(){var e,t=Ct(),n=t.country,r=t.geojsonPropertyList,i=we().data;return{country:(void 0===i?[]:i).find((function(e){return e.id===n}))||{id:-1,country:"",actived:!1},propertyList:(null===(e=r.find((function(e){return e.countryId===n})))||void 0===e?void 0:e.propertyList)||[]}},Re=function(){var e=we().data,t=(void 0===e?[]:e).find((function(e){return e.actived}));return{country:t,countryName:(null===t||void 0===t?void 0:t.country)||""}},Le=function(){var e=Se().country.country;return(0,R.useQuery)(["regionlist",e],(0,S.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X(e);case 2:return n=t.sent,t.abrupt("return",(null===n||void 0===n?void 0:n.data)||[]);case 4:case"end":return t.stop()}}),t)}))),{enabled:!!e})},Oe=function(){var e=Se().country,t=e.country,n=e.id,r=Ct().actionSetGeojsonPropertyList;return(0,R.useQuery)(["property-list",t],(0,S.Z)((0,w.Z)().mark((function e(){var n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:return n=e.sent,r=(null===n||void 0===n?void 0:n.data.split(","))||[],e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),{enabled:!!t,onSuccess:function(e){r({countryId:n,propertyList:e})}})},De=function(){var e=Se().country.country;return(0,R.useQuery)(["geojsonmap",e],(0,S.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(e);case 2:return n=t.sent,t.abrupt("return",n.data||"");case 4:case"end":return t.stop()}}),t)}))),{enabled:!!e})},Ae=function(){var e=Se().country.country,t=Le().data,n=void 0===t?[]:t,i=(0,R.useQueries)({queries:n.map((function(t){return{queryKey:["region-details",t,e],queryFn:function(){return B(e,t)},enabled:(null===n||void 0===n?void 0:n.length)>0}}))});return r.useMemo((function(){var e=i.some((function(e){return e.isLoading})),t=i.map((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.data})).filter((function(e){return!!e})).map((function(e){var t=e.energy_densisty_YTD,n=(0,ie.BQ)([t],!0),r=n.divide,i=n.unit,a=n.minFractionDigits;return(0,u.Z)((0,u.Z)({},e),{},{energy_densisty_YTD_formatted:t?(0,ie.dc)({value:t,unit:i,divide:r,fractionDigits:a}):"-",buildings_formatted:null!==e&&void 0!==e&&e.buildings?(0,ie.dc)({value:null===e||void 0===e?void 0:e.buildings}):"-",floor_area_formatted:null!==e&&void 0!==e&&e.floor_area?(0,ie.dc)({value:null===e||void 0===e?void 0:e.floor_area,unit:ie.FD}):"-",active_alerts_formatted:(null===e||void 0===e?void 0:e.active_alerts)||"-",open_tickets_formatted:(null===e||void 0===e?void 0:e.open_tickets)||"-"})})),r=t.map((function(e){return e.id})),a=t.map((function(e){return e.regionname})),o=t.map((function(e){var t=e.id,n=e.regionname,r=e.map_properties,i=r&&(0,D.V)(r)?JSON.parse(r):void 0;return{id:t,name:n,mapProperties:"undefined"!==typeof i?i:[n]}}));return{isLoading:e,regionList:t,regions:n,regionMapProperties:o,regionListIds:r,regionListName:a}}),[i])},Ie=function(){var e=Se().country.country,t=De().data,n=void 0===t?"":t;return{id:e,name:e,geometry:(0,D.V)(n)?JSON.parse(n):{},children:[]}},Me=function(){var e=Se().country.country,t=De().isLoading,n=Ie(),i=Ae(),a=i.regionMapProperties,o=i.regionListName,c=i.isLoading,s=Oe(),l=s.data,d=s.isLoading;return r.useMemo((function(){var r=(0,ie.BY)(a,n).features,i={type:"FeatureCollection",features:[]};if(n){var s=n.geometry,l=s.features;try{l=[].concat((0,T.Z)(l),(0,T.Z)(r)),i=(0,u.Z)((0,u.Z)({},s),{},{features:l})}catch(f){}}return{geojsonRegions:{id:e,name:e,geometry:i,children:[],regions:o},isLoading:t||d||c}}),[n,a,l,o,t,d,c,e])},Pe=function(){var e=(0,R.useQueryClient)();return(0,R.useMutation)((function(e){return $(e)}),{onSuccess:function(){e.invalidateQueries(["country-status-list"])}})},Ge=function(){var e=(0,R.useQueryClient)();return(0,R.useMutation)((function(e){return ee(e)}),{onSuccess:function(){e.invalidateQueries(["country-status-list"])}})},Ye=function(){var e=(0,R.useQueryClient)(),t=Se().country.country;return(0,R.useMutation)((0,S.Z)((0,w.Z)().mark((function e(){var n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:return n=e.sent,r=(0,ie.kZ)(n.data),e.next=6,Promise.all(r.map((function(e){return U(t,e,{})})));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),{onSuccess:function(n){e.refetchQueries(["regionlist",t]),n.forEach((function(n){var r=["region-details",n,t];e.refetchQueries(r,{type:"all",exact:!0})}))}})},Fe=function(){var e=Se().country.country,t=(0,R.useQueryClient)();return(0,R.useMutation)((function(e){return W(e)}),{onSuccess:function(){t.refetchQueries(["regionlist",e])}})},Qe=function(e){var t=e.isCreate,n=Se().country.country,r=(0,R.useQueryClient)(),i=(0,R.useMutation)(function(){var e=(0,S.Z)((0,w.Z)().mark((function e(r){var i,a;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.region,a=r.info,!t){e.next=6;break}return e.next=4,U(n,i,a);case 4:e.next=8;break;case 6:return e.next=8,V(n,i,a);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(e){if(t)r.refetchQueries(["regionlist",n]);else{var i=["region-details",e,n];r.refetchQueries(i,{type:"all",exact:!0})}}});return i},Be=function(e){var t=e.isCreate,n=(0,R.useQueryClient)(),r=(0,R.useMutation)(function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t){var n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.country,r=t.geojson,e.next=3,F(n,r);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(e){t?n.refetchQueries(["country-status-list"]):n.refetchQueries(["geojsonmap",e])}});return r},Ue=function(){var e=Re().countryName;return(0,R.useQuery)(["energy-consumption-".concat(e)],(0,S.Z)((0,w.Z)().mark((function t(){var n,r;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,t.next=4,q(e);case 4:r=t.sent,n=(null===r||void 0===r?void 0:r.data)||[],t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),{enabled:!!e,placeholderData:[]})},Ve=function(){var e=Ue(),t=e.data,n=void 0===t?[]:t,i=e.isLoading;return r.useMemo((function(){var e=n.map((function(e){return e.energyconsumption})),t=(0,ie.BQ)(e),r=t.divide,a=t.unit,o=n.map((function(e){var t=e.regionname;return{id:t,label:t,value:e.energyconsumption/r}}))||[],u=O()(o.map((function(e){return e.value})));return{donutText:i?"-":"".concat((0,ie.dc)({value:u,divide:1,unit:a})),subDonutText:"YTD Energy",pieData:o,isLoading:i,formatterValue:function(e){return"".concat((0,ie.dc)({value:e.value,divide:1,unit:a})," | ").concat(e.percent,"%")},renderTooltipValue:function(e){return"".concat(e.label," - ").concat((0,ie.dc)({value:e.value,divide:1,unit:a})," | ").concat(e.percent,"%")}}}),[e])},We=function(e){return(0,R.useQuery)(["energy-ranking-".concat(e)],(0,S.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H(e);case 3:return n=t.sent,t.abrupt("return",n.data||[]);case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])}))),{enabled:!!e,placeholderData:[]})},ze=function(e,t){var n=We(t),i=n.data,a=void 0===i?[]:i,o=n.isLoading;return r.useMemo((function(){var t=a.map((function(t){return e?t.energy_density:t.energy})),n=(0,ie.BQ)(t,e),r=n.divide,i=n.unit,u=n.minFractionDigits;return{isLoading:o,data:a.map((function(t){var n=t.energy,i=t.energy_density,a=t.id,o=t.buildingname,u=(e?i:n)/r;return{id:String(a),label:o,value:u}})),unit:i,minFractionDigits:u,dataResource:[]}}),[n,e])},Ke=function(e){var t=(0,R.useQueryClient)(),n=(0,R.useMutation)(function(){var t=(0,S.Z)((0,w.Z)().mark((function t(n){var r,i;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.buildingname,i=n.info,t.next=3,ne(e,r,i);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){t.refetchQueries(["energy-ranking-".concat(e)])}});return n},qe=function(e){var t=(0,R.useQueryClient)();return(0,R.useMutation)((function(e){return re(e)}),{onSuccess:function(){t.refetchQueries(["energy-ranking-".concat(e)])}})},He=function(e){return(0,R.useQuery)(["alerts-and-tickets-".concat(e)],(0,S.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)}))))},Je=function(e){var t=He(e);return r.useMemo((function(){var e=t.data,n=t.isLoading;return e?{isLoading:n,alertsFormatted:"".concat(e[_e]),ticketsFormatted:"".concat(e[Ze]),resource:e,alertsDisplayName:e[ke],ticketsDisplayName:e[Ee]}:{isLoading:n,resource:void 0,alertsFormatted:"-",ticketsFormatted:"-",alertsDisplayName:"-",ticketsDisplayName:"-"}}),[t])},Xe=function(e){var t=(0,R.useQueryClient)();return(0,R.useMutation)((function(t){return K((0,u.Z)({country:e},t))}),{onSuccess:function(){t.refetchQueries(["alerts-and-tickets-".concat(e)])}})},$e=function(){var e=(0,a.Z)().height,t=Me(),n=t.geojsonRegions,r=t.isLoading,i=Ae().regionList;return(0,l.jsx)(o.Lp,{data:{hierachy:n,width:"auto",height:e-240},renderTooltip:function(e){var t=e.name,n=null,r=y()(t),a=i.find((function(e){return v()(r,e.regionname)}));if(a){var o=a,u=o.energy_densisty_YTD_formatted,c=o.buildings_formatted,s=o.floor_area_formatted,d=o.active_alerts_formatted,f=o.open_tickets_formatted;n=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid items-center gap-2 justify-between",style:{gridTemplateColumns:"repeat(2, minmax(100px, 50%))"},children:[(0,l.jsx)("div",{className:"text-xs truncate text-gray-400",children:"".concat(c," Buildings")}),(0,l.jsx)("div",{className:"text-right text-xs truncate text-gray-400",children:s})]}),(0,l.jsx)(E,{className:"my-2"}),(0,l.jsx)("div",{className:"flex flex-row justify-around gap-3 p-3",children:[{title:"Energy Density YTD",value:u},{title:"Active Alerts",value:d},{title:"Open Tickets",value:f}].map((function(e){var t=e.title,n=e.value;return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-medium text-white text-center truncate mb-1 sub-font",children:n}),(0,l.jsx)("div",{className:"text-xs text-gray-500 truncate",children:t})]},t)}))})]})}else n=(0,l.jsx)("div",{className:"".concat(j.Z.absCenter),children:"Not data yet!"});return(0,l.jsx)(p,{className:"w-fit min-w-[380px] max-w-[400px] h-auto min-h-[150px]",title:r,panelTitleClassName:"text-sm",classNameBlockTitle:"mb-2",children:!!n&&n})},isLoading:r,classNameContainer:"z-1"})},et=r.memo($e),tt=function(){var e=Re().countryName,t=Je(e),n=t.alertsFormatted,r=t.ticketsFormatted,i=t.alertsDisplayName,a=t.ticketsDisplayName,o=t.isLoading;return(0,l.jsx)(p,{title:"".concat(i," & ").concat(a),isLoading:o,classNameBlockTitle:"mb-3",panelTitleClassName:"text-base",children:(0,l.jsx)("div",{className:"grid items-center gap-8 justify-center abs-center block-alerts-tickets w-[100%]",children:[{label:"Total ".concat(i),value:n,sub:"",icon:(0,l.jsx)("i",{className:"fa-solid fa-triangle-exclamation text-red-500 fa-2x"})},{label:"Total ".concat(a),value:r,sub:"",icon:(0,l.jsx)("i",{className:"fa-solid fa-list text-yellow-500 fa-2x"})}].map((function(e,t){var n=e.label,r=e.value,i=e.sub,a=e.icon;return(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center ".concat(0===t?"justify-self-end":"justify-self-start"),children:[(0,l.jsx)("div",{className:"text-sm text-gray-500 font-medium mb-2",children:n}),(0,l.jsxs)("div",{className:"grid items-center gap-3 alert-tickets-extra",children:[(0,l.jsx)("div",{children:a}),(0,l.jsx)("div",{className:"text-2xl sub-font font-medium truncate text-center",children:r}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:i})]})]},n)}))})})},nt=r.memo(tt),rt=n(9439),it=n(5812),at=n.n(it),ot="Ranking_style_ranking-item__sqsW-",ut=function(e){var t=e.data,n=t.rankingData,i=t.topRanking,a=void 0===i?5:i,o=t.orderBy,u=void 0===o?"desc":o,c=t.formatterValue,s=e.rankingChartContainerClassName,d=r.useMemo((function(){return n.map((function(e){return e.value}))}),[n]),f=r.useMemo((function(){return O()(d)}),[d]),p=r.useMemo((function(){return at()(n,(function(e){return e.value}),u)}),[n,u]);return(0,l.jsx)("div",{className:"ranking-chart-container ".concat(x()(s)),children:p.slice(0,a).map((function(e){return(0,l.jsxs)("div",{className:"ranking-item grid items-center gap-5 mb-2 ".concat(x()(ot)),children:[(0,l.jsx)("div",{className:"font-medium text-xs text-gray-500 truncate capitalize",children:e.label}),(0,l.jsx)("div",{className:"bg-transparent h-2 rounded relative w-[100%] min-w-[100px]",children:(0,l.jsx)("div",{className:"rounded bg-blue-500 absolute top-0 left-0 h-[100%]",style:{width:"".concat(e.value/f*100,"%")}})}),(0,l.jsx)("div",{className:"font-normal text-xs text-white truncate text-right",children:"function"===typeof c?c(e):e.value})]},e.id)}))})};ut.defaultProps={rankingChartContainerClassName:""};var ct=r.memo(ut),st=n(7309),lt=[{key:"energy",tab:"Energy"},{key:"energy-density",tab:"Energy Density"}],dt=function(){var e=r.useState(lt[0].key),t=(0,rt.Z)(e,2),n=t[0],i=t[1],a=Re().countryName,o=ze("energy-density"===n,a),u=o.data,c=o.isLoading,s=o.unit,d=o.minFractionDigits;return(0,l.jsx)(p,{title:"Ranking",sub:(0,l.jsx)("div",{className:"flex justify-end",children:lt.map((function(e){var t=e.key,r=e.tab,a=t===n;return(0,l.jsx)(st.Z,{onClick:function(){return i(t)},type:a?"primary":"default",children:r},t)}))}),isLoading:c,classNameBlockTitle:"block-ranking-title mb-3",panelTitleClassName:"text-base",children:(0,l.jsx)(ct,{data:{rankingData:u,formatterValue:function(e){var t=e.value;return(0,ie.dc)({value:t,divide:1,unit:s,fractionDigits:d})}}})})},ft=r.memo(dt),pt=n(3286),mt=function(){var e=Ve(),t=e.pieData,n=e.donutText,r=e.subDonutText,i=e.isLoading,a=e.formatterValue,o=e.renderTooltipValue;return(0,l.jsx)(p,{title:"Energy Consumption",isLoading:i,classNameBlockTitle:"mb-3",panelTitleClassName:"text-base",children:(0,l.jsx)(pt.Z,{data:{size:125,pieData:t,formatterValue:a,quantitiesItemOnChart:5,donutText:n,subDonutText:r,renderTooltipValue:o}})})},vt=r.memo(mt),gt=function(){return(0,l.jsxs)("div",{className:"relative map-page",children:[(0,l.jsx)("div",{className:"bg-no-repeat bg-center bg-auto opacity-50 absolute left-0 top-0 w-[100%] h-[100%]",style:{backgroundImage:"url(".concat(i,")")}}),(0,l.jsx)("div",{className:"bg-flash"}),(0,l.jsx)(et,{}),(0,l.jsxs)("div",{className:"extra grid gap-8 mt-5 absolute bottom-0 left-0 z-50 px-5 pb-3 extra",children:[(0,l.jsx)(vt,{}),(0,l.jsx)(ft,{}),(0,l.jsx)(nt,{})]})]})},yt=r.memo(gt),ht=n(1113),xt={country:-1,geojsonPropertyList:[]},Nt=(0,ht.M)((function(e,t){return(0,u.Z)((0,u.Z)({},xt),{},{actionSetSelectedCountry:function(t){return e({country:t})},actionSetGeojsonPropertyList:function(n){return e({geojsonPropertyList:[].concat((0,T.Z)(t().geojsonPropertyList),[n])})}})}),"MapStore"),bt=(0,rt.Z)(Nt,2),Ct=bt[0],_t=bt[1].getState,Zt=yt},7187:function(e,t,n){n.d(t,{V:function(){return r}});var r=function(e){var t=!0;try{JSON.parse(e)}catch(n){t=!1}return t}}}]);
//# sourceMappingURL=843.25a55cd9.chunk.js.map